{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Limit invoice line items to a maximum of 3 per invoice",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Enforce a maximum of 3 line items per invoice in the Invoice tab for all countries",
      "acceptanceCriteria": [
        "A user can add up to 3 line items on a single invoice.",
        "When 3 line items are present, the 'Add Line Item' button is disabled or hidden.",
        "This limit applies regardless of the selected country.",
        "Removing a line item re-enables the ability to add a new one (up to the 3-item limit).",
        "Existing invoices with fewer than 3 line items are unaffected and can still have items added up to the limit."
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/Invoice.tsx",
          "operation": "modify",
          "description": "Add logic to disable or hide the 'Add Line Item' button when the invoice already contains 3 line items. Check the lineItems array length and conditionally disable the button when lineItems.length >= 3. Ensure the button becomes enabled again when a line item is removed and the count drops below 3. This constraint must apply universally across all selected countries."
        }
      ]
    }
  ]
}